<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calcolatore Fotovoltaico Ammortamento Reale | Syncras.App</title>
<meta name="description" content="Calcola il ritorno economico reale di un impianto fotovoltaico con batteria. Autoconsumo dinamico, detrazione 50% e tabella anno per anno.">
<meta name="robots" content="index,follow">
<link rel="canonical" href="https://syncras.app/calcolatore-fotovoltaico-ammortamento.html">

<style>
:root{
  --violet:#6C5CE7;
  --violet-dark:#4B3ACB;
  --bg:#F7F7FB;
  --text:#403E43;
  --ok:#16A34A;
  --warn:#D97706;
  --bad:#DC2626;
}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}
main{
  max-width:1000px;
  margin:30px auto;
  background:#fff;
  padding:24px;
  border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,.08);
}
h1,h2,h3{color:var(--violet-dark)}
.calc-box{
  background:#f9fafb;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding:18px;
  margin-bottom:20px;
}
.calc-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:14px;
}
label{
  font-weight:600;
  font-size:.9rem;
}
input,select{
  width:100%;
  padding:8px;
  border-radius:6px;
  border:1px solid #d1d5db;
  margin-top:4px;
}
button{
  background:var(--violet);
  color:#fff;
  border:none;
  padding:10px 18px;
  border-radius:8px;
  cursor:pointer;
  font-weight:700;
}
button:hover{background:var(--violet-dark)}
.result{
  display:none;
  background:#fff;
  border-radius:10px;
  padding:16px;
  margin-top:16px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}
.legal-box{
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:8px;
  padding:12px;
  margin-top:14px;
}
.legal-box.focus{
  outline:3px solid #f59e0b;
}
.small{
  font-size:.85rem;
  color:#6b7280;
}
.center{text-align:center}
hr{border:none;border-top:1px solid #e5e7eb;margin:14px 0}

.table-wrap{overflow-x:auto;margin-top:12px}
table{width:100%;border-collapse:collapse;font-size:.9rem}
th,td{border:1px solid #d1d5db;padding:8px 10px;text-align:right;white-space:nowrap}
th{text-align:center;background:#eef2ff}
td:first-child, th:first-child{text-align:center}
.row-break{background:#dcfce7;font-weight:800}
.badge{
  display:inline-block;
  padding:6px 10px;
  border-radius:999px;
  color:#fff;
  font-weight:800;
  font-size:.85rem;
}
.badge-ok{background:var(--ok)}
.badge-warn{background:var(--warn)}
.badge-bad{background:var(--bad)}
</style>
</head>

<body>
<main>

<h1>‚òÄÔ∏è Calcolatore Fotovoltaico ‚Äì Ammortamento Reale</h1>

<div class="calc-box">
<h2>Dati impianto</h2>
<div class="calc-grid">
  <div>
    <label>Potenza impianto (kW)</label>
    <input id="potenza" type="number" value="6" min="1" max="20" step="0.1">
  </div>
  <div>
    <label>Zona geografica</label>
    <select id="zona">
      <option value="1100">Nord Italia (~1100 kWh/kW)</option>
      <option value="1300" selected>Centro Italia (~1300 kWh/kW)</option>
      <option value="1500">Sud Italia (~1500 kWh/kW)</option>
    </select>
  </div>
  <div>
    <label>Consumo annuo casa (kWh)</label>
    <input id="consumoCasa" type="number" value="3000" min="0" step="50">
  </div>
  <div>
    <label>Batteria (kWh) ‚Äî libera 5‚Äì50</label>
    <input id="batteria" type="number" value="10" min="5" max="50" step="0.5">
  </div>
</div>
</div>

<div class="calc-box">
<h2>Costi e incentivi</h2>
<div class="calc-grid">
  <div>
    <label>Prezzo energia acquistata (‚Ç¨/kWh)</label>
    <input id="prezzoAcquisto" type="number" value="0.30" step="0.01" min="0">
  </div>
  <div>
    <label>Prezzo cessione (‚Ç¨/kWh)</label>
    <input id="prezzoCessione" type="number" value="0.10" step="0.01" min="0">
  </div>
  <div>
    <label>Costo impianto (‚Ç¨)</label>
    <input id="costoImpianto" type="number" value="10000" step="100" min="0">
  </div>
  <div>
    <label>Orizzonte ammortamento (anni)</label>
    <input id="anni" type="number" value="20" min="5" max="30">
  </div>
</div>
<p class="small" style="margin:10px 0 0">
Detrazione: <strong>50%</strong> ripartita su <strong>10 anni</strong> (valore indicativo: non sostituisce un tecnico/commercialista).
Degrado pannelli: <strong>0,5% annuo</strong>.
</p>
</div>

<div class="legal-box" id="legalBox">
<label>
<input type="checkbox" id="legalCheck">
 Confermo di aver letto le <a href="note-legali.html" target="_blank" rel="noopener">Note Legali</a>
</label>
<p class="small">I risultati sono stime indicative e non costituiscono consulenza professionale.</p>
</div>

<div class="center" style="margin-top:18px">
<button onclick="calcola()">Calcola (con ammortamento)</button>
</div>

<div id="result" class="result"></div>

<div class="center" style="margin-top:18px">
<button id="shareBtn" style="display:none">üìé Condividi il risultato</button>
</div>

</main>

<script>
function euro0(v){ return (Number(v)||0).toFixed(0).replace('.',','); }
function euro2(v){ return (Number(v)||0).toFixed(2).replace('.',','); }

function scrollToLegal(){
  const box=document.getElementById('legalBox');
  box.classList.add('focus');
  box.scrollIntoView({behavior:'smooth',block:'center'});
  setTimeout(()=>box.classList.remove('focus'),2500);
}

// === AUTOCONSUMO DINAMICO ===
// idea: autoconsumo = istantaneo (base) + quota spostabile con batteria (limitata da batteria vs produzione giornaliera)
// poi limitato da: consumi casa e cap fisico 90% della produzione
function computeDynamicAutoconsumo(produzioneAnnua, consumoCasaAnnua, batteriaKWh){
  const prodGiorno = produzioneAnnua / 365;

  // autoconsumo istantaneo base (media)
  const baseInstant = produzioneAnnua * 0.25;

  // fattore batteria: se batteria >= produzione giornaliera, "sposta" bene; se √® piccola, sposta poco
  const fattoreBat = Math.min(1, (batteriaKWh / Math.max(prodGiorno, 0.001)));

  // quota differita massima teorica (euristica) * fattoreBat
  const differita = produzioneAnnua * 0.45 * fattoreBat;

  // somma e limiti reali
  let autoc = baseInstant + differita;
  autoc = Math.min(autoc, produzioneAnnua);            // non pu√≤ superare la produzione
  autoc = Math.min(autoc, consumoCasaAnnua);           // non pu√≤ superare i consumi casa annui
  autoc = Math.min(autoc, produzioneAnnua * 0.90);     // cap fisico (perdite, mismatch, ecc.)

  return { autoconsumoKWh: autoc, fattoreBat };
}

function calcola(){
  if(!document.getElementById('legalCheck').checked){
    scrollToLegal();
    return;
  }

  const potenza = +document.getElementById('potenza').value || 0;
  const zona = +document.getElementById('zona').value || 0;
  const consumo = +document.getElementById('consumoCasa').value || 0;
  const batteria = +document.getElementById('batteria').value || 0;

  const prezzoAcq = +document.getElementById('prezzoAcquisto').value || 0;
  const prezzoCes = +document.getElementById('prezzoCessione').value || 0;

  const costo = +document.getElementById('costoImpianto').value || 0;
  const anni = parseInt(document.getElementById('anni').value) || 20;

  if(potenza<=0 || zona<=0){
    alert("Inserisci almeno potenza e zona.");
    return;
  }

  const produzione = potenza * zona;

  const dyn = computeDynamicAutoconsumo(produzione, consumo, batteria);
  const autoconsumo = dyn.autoconsumoKWh;

  const cessione = Math.max(0, produzione - autoconsumo);

  const risparmioCasa = autoconsumo * prezzoAcq;
  const ricavoCessione = cessione * prezzoCes;

  const beneficioFV = risparmioCasa + ricavoCessione;

  // detrazione: 50% del costo, spalmata su 10 anni
  const detrazioneTot = costo * 0.50;
  const detrazioneAnnua = detrazioneTot / 10;

  // === Ammortamento anno per anno ===
  let cumul = -costo;
  let breakYear = -1;

  let rows = "";
  for(let i=1;i<=anni;i++){
    const degr = Math.pow(0.995, i-1); // 0,5% annuo
    const benefAnno = beneficioFV * degr;

    const detr = (i<=10) ? detrazioneAnnua : 0;

    const totaleAnno = benefAnno + detr;
    cumul += totaleAnno;

    if(breakYear===-1 && cumul>=0) breakYear=i;

    rows += `
      <tr class="${(i===breakYear)?'row-break':''}">
        <td>${i}</td>
        <td>${euro0(benefAnno)} ‚Ç¨</td>
        <td>${euro0(detr)} ‚Ç¨</td>
        <td><strong>${euro0(totaleAnno)} ‚Ç¨</strong></td>
        <td style="color:${cumul>=0?'var(--ok)':'#b91c1c'}"><strong>${euro0(cumul)} ‚Ç¨</strong></td>
        <td>${euro0(Math.max(0,-cumul))} ‚Ç¨</td>
      </tr>
    `;
  }

  const badge = (breakYear!==-1)
    ? `<span class="badge badge-ok">‚úÖ Rientro stimato: ~ ${breakYear} anni</span>`
    : `<span class="badge badge-warn">‚ö†Ô∏è Non si ripaga entro ${anni} anni</span>`;

  const resultHtml = `
    <h3>Risultato annuale</h3>
    ${badge}
    <p class="small" style="margin-top:10px">
      Autoconsumo calcolato in modo dinamico (dipende da batteria vs produzione giornaliera) e limitato da consumi reali + cap fisico.
    </p>

    <p>Produzione stimata: <strong>${euro0(produzione)} kWh/anno</strong></p>
    <p>Energia autoconsumata: <strong>${euro0(autoconsumo)} kWh/anno</strong></p>
    <p>Energia ceduta: <strong>${euro0(cessione)} kWh/anno</strong></p>

    <hr>

    <h3>Somma ‚Äúin colonna‚Äù</h3>
    <p>Risparmio bolletta (energia usata in casa): <strong>${euro0(risparmioCasa)} ‚Ç¨</strong></p>
    <p>Ricavo cessione (energia venduta): <strong>${euro0(ricavoCessione)} ‚Ç¨</strong></p>
    <p><strong>Totale beneficio FV annuo (casa + cessione): ${euro0(beneficioFV)} ‚Ç¨</strong></p>
    <p class="small">Detrazione 50%: <strong>${euro0(detrazioneTot)} ‚Ç¨</strong> totali (‚âà ${euro0(detrazioneAnnua)} ‚Ç¨/anno per 10 anni)</p>

    <hr>

    <h3>Ammortamento anno per anno</h3>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Anno</th>
            <th>Beneficio FV (degrado incluso)</th>
            <th>Detrazione</th>
            <th>Totale anno</th>
            <th>Cumulativo</th>
            <th>Capitale residuo</th>
          </tr>
        </thead>
        <tbody>
          ${rows}
        </tbody>
      </table>
    </div>

    <p class="small" style="margin-top:10px">
      Note: degrado pannelli 0,5%/anno; prezzi energia considerati costanti; detrazione stimata in modo semplificato.
    </p>
  `;

  const box=document.getElementById('result');
  box.innerHTML = resultHtml;
  box.style.display='block';

  // share risultato: solo se supportato
  const shareBtn = document.getElementById('shareBtn');
  if(navigator.share){
    shareBtn.style.display = 'inline-block';
    shareBtn.onclick = async () => {
      try{
        await navigator.share({
          title: 'Simulazione FV ‚Äì Syncras.App',
          text: `Risultato FV (stima):
Produzione: ${euro0(produzione)} kWh/anno
Autoconsumo: ${euro0(autoconsumo)} kWh/anno
Risparmio: ${euro0(risparmioCasa)} ‚Ç¨
Cessione: ${euro0(ricavoCessione)} ‚Ç¨
Beneficio FV: ${euro0(beneficioFV)} ‚Ç¨
${breakYear!==-1 ? ('Rientro: ~'+breakYear+' anni') : ('Non si ripaga entro '+anni+' anni')}
`,
          url: window.location.href
        });
      }catch(e){}
    };
  } else {
    shareBtn.style.display = 'none';
  }
}
</script>

<!-- GDPR banner + GA solo dopo consenso -->
<div id="cookie-banner" style="display:none;position:fixed;bottom:20px;left:50%;transform:translateX(-50%);
background:#fff;border:2px solid #6C5CE7;border-radius:10px;padding:14px;z-index:9999;max-width:520px;width:92%">
  <p class="small" style="margin:0 0 10px 0">
    Usiamo cookie tecnici e Analytics anonimo (solo dopo consenso).
    <a href="privacy.html">Privacy</a> ‚Äì <a href="cookie.html">Cookie</a>
  </p>
  <div style="display:flex;gap:10px;flex-wrap:wrap">
    <button style="background:#fff;color:#111827;border:2px solid #6C5CE7" onclick="reject()">Rifiuta</button>
    <button onclick="accept()">Accetta</button>
  </div>
</div>

<script>
const KEY="syncras_consent";
const GA="G-CFTTCYDZ2P";
function loadGA(){
  if(window.__gaLoaded) return;
  window.__gaLoaded = true;
  const s=document.createElement('script');
  s.async=true;
  s.src="https://www.googletagmanager.com/gtag/js?id="+GA;
  document.head.appendChild(s);
  window.dataLayer=window.dataLayer||[];
  function gtag(){dataLayer.push(arguments);}
  gtag('js',new Date());
  gtag('config',GA,{anonymize_ip:true});
}
function accept(){localStorage.setItem(KEY,'yes');loadGA();hide()}
function reject(){localStorage.setItem(KEY,'no');hide()}
function hide(){document.getElementById('cookie-banner').style.display='none'}
document.addEventListener('DOMContentLoaded',()=>{
  const c=localStorage.getItem(KEY);
  if(c==='yes') loadGA();
  if(!c) document.getElementById('cookie-banner').style.display='block';
});
</script>

</body>
</html>



